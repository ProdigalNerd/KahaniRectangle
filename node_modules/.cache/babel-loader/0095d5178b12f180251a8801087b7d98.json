{"ast":null,"code":"import { Util } from '../Util.js';\nimport { Factory } from '../Factory.js';\nimport { Shape } from '../Shape.js';\nimport { getNumberValidator } from '../Validators.js';\nimport { _registerNode } from '../Global.js';\nexport class Image extends Shape {\n  constructor(attrs) {\n    super(attrs);\n    this.on('imageChange.konva', () => {\n      this._setImageLoad();\n    });\n    this._setImageLoad();\n  }\n  _setImageLoad() {\n    const image = this.image();\n    if (image && image.complete) {\n      return;\n    }\n    if (image && image.readyState === 4) {\n      return;\n    }\n    if (image && image['addEventListener']) {\n      image['addEventListener']('load', () => {\n        this._requestDraw();\n      });\n    }\n  }\n  _useBufferCanvas() {\n    return super._useBufferCanvas(true);\n  }\n  _sceneFunc(context) {\n    const width = this.getWidth();\n    const height = this.getHeight();\n    const image = this.attrs.image;\n    let params;\n    if (image) {\n      const cropWidth = this.attrs.cropWidth;\n      const cropHeight = this.attrs.cropHeight;\n      if (cropWidth && cropHeight) {\n        params = [image, this.cropX(), this.cropY(), cropWidth, cropHeight, 0, 0, width, height];\n      } else {\n        params = [image, 0, 0, width, height];\n      }\n    }\n    if (this.hasFill() || this.hasStroke()) {\n      context.beginPath();\n      context.rect(0, 0, width, height);\n      context.closePath();\n      context.fillStrokeShape(this);\n    }\n    if (image) {\n      context.drawImage.apply(context, params);\n    }\n  }\n  _hitFunc(context) {\n    var width = this.width(),\n      height = this.height();\n    context.beginPath();\n    context.rect(0, 0, width, height);\n    context.closePath();\n    context.fillStrokeShape(this);\n  }\n  getWidth() {\n    var _a, _b;\n    return (_a = this.attrs.width) !== null && _a !== void 0 ? _a : (_b = this.image()) === null || _b === void 0 ? void 0 : _b.width;\n  }\n  getHeight() {\n    var _a, _b;\n    return (_a = this.attrs.height) !== null && _a !== void 0 ? _a : (_b = this.image()) === null || _b === void 0 ? void 0 : _b.height;\n  }\n  static fromURL(url, callback) {\n    let onError = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    var img = Util.createImageElement();\n    img.onload = function () {\n      var image = new Image({\n        image: img\n      });\n      callback(image);\n    };\n    img.onerror = onError;\n    img.crossOrigin = 'Anonymous';\n    img.src = url;\n  }\n}\nImage.prototype.className = 'Image';\n_registerNode(Image);\nFactory.addGetterSetter(Image, 'image');\nFactory.addComponentsGetterSetter(Image, 'crop', ['x', 'y', 'width', 'height']);\nFactory.addGetterSetter(Image, 'cropX', 0, getNumberValidator());\nFactory.addGetterSetter(Image, 'cropY', 0, getNumberValidator());\nFactory.addGetterSetter(Image, 'cropWidth', 0, getNumberValidator());\nFactory.addGetterSetter(Image, 'cropHeight', 0, getNumberValidator());","map":{"version":3,"names":["Util","Factory","Shape","getNumberValidator","_registerNode","Image","constructor","attrs","on","_setImageLoad","image","complete","readyState","_requestDraw","_useBufferCanvas","_sceneFunc","context","width","getWidth","height","getHeight","params","cropWidth","cropHeight","cropX","cropY","hasFill","hasStroke","beginPath","rect","closePath","fillStrokeShape","drawImage","apply","_hitFunc","_a","_b","fromURL","url","callback","onError","img","createImageElement","onload","onerror","crossOrigin","src","prototype","className","addGetterSetter","addComponentsGetterSetter"],"sources":["/Users/tylerwilson/Documents/GitHub/KahaniRectangle/kahani-rectangle/node_modules/konva/lib/shapes/Image.js"],"sourcesContent":["import { Util } from '../Util.js';\nimport { Factory } from '../Factory.js';\nimport { Shape } from '../Shape.js';\nimport { getNumberValidator } from '../Validators.js';\nimport { _registerNode } from '../Global.js';\nexport class Image extends Shape {\n    constructor(attrs) {\n        super(attrs);\n        this.on('imageChange.konva', () => {\n            this._setImageLoad();\n        });\n        this._setImageLoad();\n    }\n    _setImageLoad() {\n        const image = this.image();\n        if (image && image.complete) {\n            return;\n        }\n        if (image && image.readyState === 4) {\n            return;\n        }\n        if (image && image['addEventListener']) {\n            image['addEventListener']('load', () => {\n                this._requestDraw();\n            });\n        }\n    }\n    _useBufferCanvas() {\n        return super._useBufferCanvas(true);\n    }\n    _sceneFunc(context) {\n        const width = this.getWidth();\n        const height = this.getHeight();\n        const image = this.attrs.image;\n        let params;\n        if (image) {\n            const cropWidth = this.attrs.cropWidth;\n            const cropHeight = this.attrs.cropHeight;\n            if (cropWidth && cropHeight) {\n                params = [\n                    image,\n                    this.cropX(),\n                    this.cropY(),\n                    cropWidth,\n                    cropHeight,\n                    0,\n                    0,\n                    width,\n                    height,\n                ];\n            }\n            else {\n                params = [image, 0, 0, width, height];\n            }\n        }\n        if (this.hasFill() || this.hasStroke()) {\n            context.beginPath();\n            context.rect(0, 0, width, height);\n            context.closePath();\n            context.fillStrokeShape(this);\n        }\n        if (image) {\n            context.drawImage.apply(context, params);\n        }\n    }\n    _hitFunc(context) {\n        var width = this.width(), height = this.height();\n        context.beginPath();\n        context.rect(0, 0, width, height);\n        context.closePath();\n        context.fillStrokeShape(this);\n    }\n    getWidth() {\n        var _a, _b;\n        return (_a = this.attrs.width) !== null && _a !== void 0 ? _a : (_b = this.image()) === null || _b === void 0 ? void 0 : _b.width;\n    }\n    getHeight() {\n        var _a, _b;\n        return (_a = this.attrs.height) !== null && _a !== void 0 ? _a : (_b = this.image()) === null || _b === void 0 ? void 0 : _b.height;\n    }\n    static fromURL(url, callback, onError = null) {\n        var img = Util.createImageElement();\n        img.onload = function () {\n            var image = new Image({\n                image: img,\n            });\n            callback(image);\n        };\n        img.onerror = onError;\n        img.crossOrigin = 'Anonymous';\n        img.src = url;\n    }\n}\nImage.prototype.className = 'Image';\n_registerNode(Image);\nFactory.addGetterSetter(Image, 'image');\nFactory.addComponentsGetterSetter(Image, 'crop', ['x', 'y', 'width', 'height']);\nFactory.addGetterSetter(Image, 'cropX', 0, getNumberValidator());\nFactory.addGetterSetter(Image, 'cropY', 0, getNumberValidator());\nFactory.addGetterSetter(Image, 'cropWidth', 0, getNumberValidator());\nFactory.addGetterSetter(Image, 'cropHeight', 0, getNumberValidator());\n"],"mappings":"AAAA,SAASA,IAAI,QAAQ,YAAY;AACjC,SAASC,OAAO,QAAQ,eAAe;AACvC,SAASC,KAAK,QAAQ,aAAa;AACnC,SAASC,kBAAkB,QAAQ,kBAAkB;AACrD,SAASC,aAAa,QAAQ,cAAc;AAC5C,OAAO,MAAMC,KAAK,SAASH,KAAK,CAAC;EAC7BI,WAAW,CAACC,KAAK,EAAE;IACf,KAAK,CAACA,KAAK,CAAC;IACZ,IAAI,CAACC,EAAE,CAAC,mBAAmB,EAAE,MAAM;MAC/B,IAAI,CAACC,aAAa,EAAE;IACxB,CAAC,CAAC;IACF,IAAI,CAACA,aAAa,EAAE;EACxB;EACAA,aAAa,GAAG;IACZ,MAAMC,KAAK,GAAG,IAAI,CAACA,KAAK,EAAE;IAC1B,IAAIA,KAAK,IAAIA,KAAK,CAACC,QAAQ,EAAE;MACzB;IACJ;IACA,IAAID,KAAK,IAAIA,KAAK,CAACE,UAAU,KAAK,CAAC,EAAE;MACjC;IACJ;IACA,IAAIF,KAAK,IAAIA,KAAK,CAAC,kBAAkB,CAAC,EAAE;MACpCA,KAAK,CAAC,kBAAkB,CAAC,CAAC,MAAM,EAAE,MAAM;QACpC,IAAI,CAACG,YAAY,EAAE;MACvB,CAAC,CAAC;IACN;EACJ;EACAC,gBAAgB,GAAG;IACf,OAAO,KAAK,CAACA,gBAAgB,CAAC,IAAI,CAAC;EACvC;EACAC,UAAU,CAACC,OAAO,EAAE;IAChB,MAAMC,KAAK,GAAG,IAAI,CAACC,QAAQ,EAAE;IAC7B,MAAMC,MAAM,GAAG,IAAI,CAACC,SAAS,EAAE;IAC/B,MAAMV,KAAK,GAAG,IAAI,CAACH,KAAK,CAACG,KAAK;IAC9B,IAAIW,MAAM;IACV,IAAIX,KAAK,EAAE;MACP,MAAMY,SAAS,GAAG,IAAI,CAACf,KAAK,CAACe,SAAS;MACtC,MAAMC,UAAU,GAAG,IAAI,CAAChB,KAAK,CAACgB,UAAU;MACxC,IAAID,SAAS,IAAIC,UAAU,EAAE;QACzBF,MAAM,GAAG,CACLX,KAAK,EACL,IAAI,CAACc,KAAK,EAAE,EACZ,IAAI,CAACC,KAAK,EAAE,EACZH,SAAS,EACTC,UAAU,EACV,CAAC,EACD,CAAC,EACDN,KAAK,EACLE,MAAM,CACT;MACL,CAAC,MACI;QACDE,MAAM,GAAG,CAACX,KAAK,EAAE,CAAC,EAAE,CAAC,EAAEO,KAAK,EAAEE,MAAM,CAAC;MACzC;IACJ;IACA,IAAI,IAAI,CAACO,OAAO,EAAE,IAAI,IAAI,CAACC,SAAS,EAAE,EAAE;MACpCX,OAAO,CAACY,SAAS,EAAE;MACnBZ,OAAO,CAACa,IAAI,CAAC,CAAC,EAAE,CAAC,EAAEZ,KAAK,EAAEE,MAAM,CAAC;MACjCH,OAAO,CAACc,SAAS,EAAE;MACnBd,OAAO,CAACe,eAAe,CAAC,IAAI,CAAC;IACjC;IACA,IAAIrB,KAAK,EAAE;MACPM,OAAO,CAACgB,SAAS,CAACC,KAAK,CAACjB,OAAO,EAAEK,MAAM,CAAC;IAC5C;EACJ;EACAa,QAAQ,CAAClB,OAAO,EAAE;IACd,IAAIC,KAAK,GAAG,IAAI,CAACA,KAAK,EAAE;MAAEE,MAAM,GAAG,IAAI,CAACA,MAAM,EAAE;IAChDH,OAAO,CAACY,SAAS,EAAE;IACnBZ,OAAO,CAACa,IAAI,CAAC,CAAC,EAAE,CAAC,EAAEZ,KAAK,EAAEE,MAAM,CAAC;IACjCH,OAAO,CAACc,SAAS,EAAE;IACnBd,OAAO,CAACe,eAAe,CAAC,IAAI,CAAC;EACjC;EACAb,QAAQ,GAAG;IACP,IAAIiB,EAAE,EAAEC,EAAE;IACV,OAAO,CAACD,EAAE,GAAG,IAAI,CAAC5B,KAAK,CAACU,KAAK,MAAM,IAAI,IAAIkB,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAG,CAACC,EAAE,GAAG,IAAI,CAAC1B,KAAK,EAAE,MAAM,IAAI,IAAI0B,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACnB,KAAK;EACrI;EACAG,SAAS,GAAG;IACR,IAAIe,EAAE,EAAEC,EAAE;IACV,OAAO,CAACD,EAAE,GAAG,IAAI,CAAC5B,KAAK,CAACY,MAAM,MAAM,IAAI,IAAIgB,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAG,CAACC,EAAE,GAAG,IAAI,CAAC1B,KAAK,EAAE,MAAM,IAAI,IAAI0B,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACjB,MAAM;EACvI;EACA,OAAOkB,OAAO,CAACC,GAAG,EAAEC,QAAQ,EAAkB;IAAA,IAAhBC,OAAO,uEAAG,IAAI;IACxC,IAAIC,GAAG,GAAGzC,IAAI,CAAC0C,kBAAkB,EAAE;IACnCD,GAAG,CAACE,MAAM,GAAG,YAAY;MACrB,IAAIjC,KAAK,GAAG,IAAIL,KAAK,CAAC;QAClBK,KAAK,EAAE+B;MACX,CAAC,CAAC;MACFF,QAAQ,CAAC7B,KAAK,CAAC;IACnB,CAAC;IACD+B,GAAG,CAACG,OAAO,GAAGJ,OAAO;IACrBC,GAAG,CAACI,WAAW,GAAG,WAAW;IAC7BJ,GAAG,CAACK,GAAG,GAAGR,GAAG;EACjB;AACJ;AACAjC,KAAK,CAAC0C,SAAS,CAACC,SAAS,GAAG,OAAO;AACnC5C,aAAa,CAACC,KAAK,CAAC;AACpBJ,OAAO,CAACgD,eAAe,CAAC5C,KAAK,EAAE,OAAO,CAAC;AACvCJ,OAAO,CAACiD,yBAAyB,CAAC7C,KAAK,EAAE,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC;AAC/EJ,OAAO,CAACgD,eAAe,CAAC5C,KAAK,EAAE,OAAO,EAAE,CAAC,EAAEF,kBAAkB,EAAE,CAAC;AAChEF,OAAO,CAACgD,eAAe,CAAC5C,KAAK,EAAE,OAAO,EAAE,CAAC,EAAEF,kBAAkB,EAAE,CAAC;AAChEF,OAAO,CAACgD,eAAe,CAAC5C,KAAK,EAAE,WAAW,EAAE,CAAC,EAAEF,kBAAkB,EAAE,CAAC;AACpEF,OAAO,CAACgD,eAAe,CAAC5C,KAAK,EAAE,YAAY,EAAE,CAAC,EAAEF,kBAAkB,EAAE,CAAC"},"metadata":{},"sourceType":"module"}